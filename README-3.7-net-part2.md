# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. На лекции мы обсудили, что манипулировать размером окна необходимо для эффективного наполнения приемного буфера участников TCP сессии (Flow Control). Подобная проблема в полной мере возникает в сетях с высоким RTT. Например, если вы захотите передать 500 Гб бэкап из региона Юга-Восточной Азии на Восточное побережье США. [Здесь](https://www.cloudping.co/grid) вы можете увидеть и 200 и 400 мс вполне реального RTT. Подсчитайте, какого размера нужно окно TCP чтобы наполнить 1 Гбит/с канал при 300 мс RTT (берем простую ситуацию без потери пакетов). Можно воспользоваться готовым [калькулятором](https://www.switch.ch/network/tools/tcp_throughput/). Ознакомиться с [формулами](https://en.wikipedia.org/wiki/TCP_tuning), по которым работает калькулятор можно, например, на Wiki.



> Для расчёта максимального размера окна (т.е. максимальный объем данных, которые могут передаваться одним пользователем другому в канале связи) рассчитывается по формуле:

> Полоса пропускания (бит/сек) * RTT (круговое время передачи по сети) = размер окна в битах

> Т.е. 1 024 000 000 бит/c х 0,300 с = 307 200 000  бит (38 400  KByte) или (38,4 Мбайт)



2. Какая  максимальная реальная скорость передачи данных достижима при линке 100 Мбит/с? Вопрос про TCP payload, то есть цифры, которые вы реально увидите в операционной системе в тестах или в браузере при скачивании файлов. Повлияет ли размер фрейма на это?

> Максимальная реальная скорость ПД при линке 100 Мбит/c в сети без потерь равная 100 Мбит/c за вычетом полосы служебного оверхеад (troughput - goodput) обычно около 10-7% от полосы, зависит от величины фреймов и MTU и фрагментации. Т.е. реально на 100 Мбит/c получить от 90 до 93 Мбит/c. 
> Повлияет размер MTU, не фрейма. Если MTU + заголовок IPv4 (20 байт) + заголовок Eth (20 байт) будет меньше фрейма (в реальности не припоминаю, что такое возможно создать), то может стать только хуже, так как будем гонять "воздух" в фреймах. Наоборот, если его увеличить больше размера минимального MTU любого соседнего устройстве на пути фрейма, произойдет фрагментация.  Размер MTU повлияет, если его выставить максимальным до фрагментации на всех устройствах от точки А до Б.
> Если предположить, что фрагментации и потерь нет, и передается только IPv4, и MTU 1500 байт, то на заголовки IPv4 + Eth тратися 40 байт, а на goodput остается 1460 байт. Соответственно 40/1460 * 100% = 2,74% (служебный оверхеад) и 97,26% goodput.


3. Что на самом деле происходит, когда вы открываете сайт? :)
На прошлой лекции был приведен сокращенный вариант ответа на этот вопрос. Теперь вы знаете намного больше, в частности про IP адресацию, DNS и т.д.
Опишите максимально подробно насколько вы это можете сделать, что происходит, когда вы делаете запрос `curl -I http://netology.ru` с вашей рабочей станции. Предположим, что arp кеш очищен, в локальном DNS нет закешированных записей.


> Если arp-кэш очищен и в локальном DNS нет закэшированных записей и по дороге нет веб-прокси и в hosts не прописан запрашиваемый домен, то
> Пакет curl создаст запрос http с uri http://netology.ru и вернет результат в stdout, для этого:
* curl оперируя на 7-м прикладном уровне OSI отправит запрос на резолвер прописанный в /etc/resolv.conf, в случае если там прописан DNS создастся DNS запрос вида A, по которому будет запрошен IP версии 4 или 6 в зависимости от IP адреса резолвера. В ответ на DNS запрос записи А или ААА (если IPv6) сервер вернет IP.
* На 6-м уровне (представительском), в той кодировке, которая была использована при отправке в stdin,произойдет отправка данных кодирование/декодирование (при ответе) в формат для передачи/полчучения по/из сети.
* На 5-м сеансовом уровне так как запрос по протоколу http, а не https процесс установления шифрованного соединения SSL с ключами произведен не будет.
* На 4-м транспортном уровне, так как для установления по протоколу http требуется фаза предварительной установки соединения, данные будут инкапсулированы в сегмент TCP, который перед передачей выполнит 3 фазный хендшейк с удаленным сервером. Сегменты включающие заголовки TCP, в которых так же будет фигурировать порт сервера HTTP - 80 и непривелигированный клиента, будут отправлены нижестоящему IP на 3-м сетевом уровне, учитывая MSS и размером окна.
* На 3-м сетевом уровне, используя IP для указания в поле dst, а так же IP сетевого интерфейса отправки в поле src, пакет будет подготовлен с установленным параметрами DF, DSCP, .... Перед отправкой будет просмотрена дефолтная маршрутная таблица номер 255 (так полиси роутинг не настраивали) в ней будет найден IP шлюза по-умолчанию или адрес ендпоинта ppp интерфейса. 
* На 2-м канальном уровне (вероятнее всего ethernet) пакеты будут инкапсулированы во фрейм Eth c МАС адресом интерфейса отправления и МАС адреса назначения шлюза, IP которого будет определени из маршрутной таблицы. Будут установлен номер влана, CoS.
* На 1-м физическом уровне информация будет преобразована в единицы нули или получена в таком виде по принятому шиврофанию отправлена/получена из среды передачи.


4. Сколько и каких итеративных запросов будет сделано при резолве домена `www.google.co.uk`?

> Если у сервера не будет информации о запрашиваемом домене, то будет выполнено 4 итеративных запроса (www.google.co.uk). IN A или IN AAA, в зависимости ipv4 или ipv6.

5. Сколько доступно для назначения хостам адресов в подсети `/25`? А в подсети с маской `255.248.0.0`. Постарайтесь потренироваться в ручных вычислениях чтобы немного набить руку, не пользоваться калькулятором сразу.

> /25 - 128 минус 2 (шлюз и броадкаст), 255.248.0.0 - 262144 минус 2 


6. В какой подсети больше адресов, в `/23` или `/24`?

> В /23

7. Получится ли разделить диапазон `10.0.0.0/8` на 128 подсетей по 131070 адресов в каждой? Какая маска будет у таких подсетей?

> Да, /15

 
 ---

## Как сдавать задания

Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.

Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

Также вы можете выполнить задание в [Google Docs](https://docs.google.com/document/u/0/?tgif=d) и отправить в личном кабинете на проверку ссылку на ваш документ.
Название файла Google Docs должно содержать номер лекции и фамилию студента. Пример названия: "1.1. Введение в DevOps — Сусанна Алиева".

Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Перед тем как выслать ссылку, убедитесь, что ее содержимое не является приватным (открыто на комментирование всем, у кого есть ссылка), иначе преподаватель не сможет проверить работу. Чтобы это проверить, откройте ссылку в браузере в режиме инкогнито.

[Как предоставить доступ к файлам и папкам на Google Диске](https://support.google.com/docs/answer/2494822?hl=ru&co=GENIE.Platform%3DDesktop)

[Как запустить chrome в режиме инкогнито ](https://support.google.com/chrome/answer/95464?co=GENIE.Platform%3DDesktop&hl=ru)

[Как запустить  Safari в режиме инкогнито ](https://support.apple.com/ru-ru/guide/safari/ibrw1069/mac)

Любые вопросы по решению задач задавайте в чате Slack.

---
